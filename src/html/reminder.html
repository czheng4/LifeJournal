<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="../../node_modules/bootstrap/dist/css/bootstrap.min.css">
	<link href="../../fontawesome/css/all.css" rel="stylesheet">
	<script src="../../node_modules/jquery/dist/jquery.min.js"></script>
	<link href="../../src/css/blue.css" rel="stylesheet">
	<title></title>
	<style type="text/css">

		.header
		{
			position: absolute;
			width: 90%;
			top:5%;
			left: 5%;
			height: 8%;
			background-color: grey;
			overflow: scroll;
			border-top-left-radius: 5px;
			border-top-right-radius: 5px;
		}
		.box
		{
			position: absolute;
			width: 90%;
			top:13%;
			left: 5%;
			height: 80%;
			background-color: silver;
			overflow: scroll;
			border-bottom-left-radius: 5px;
			border-bottom-right-radius: 5px;
		}

		pre
		{
			overflow-y: scroll;
			overflow-x: hidden;
			white-space: normal;
			outline: none;
			
			margin-left: 5%;
			display: inline-grid;
		}
		
		i
		{
			margin-left: 5%;
		}
		span
		{
			margin-left: 5%;
		}

		#title:empty::before
		{
			content: "Title";
		}

		#description:empty::before
		{
			content: "Description";
			cursor: text;
		}
		a
		{
			color: black;
		}
		a:hover
		{
			color:red;
		}

		.gap
		{
			background-color: white;
			width: 100%;
			height: 10px;
		}
		
		/* alarm */
		.reminder
    	{ 
    		position: absolute;
			width: 70%;
			top:20%;
			left: 15%;
			height: 60%;
			background-color: red;
			overflow: scroll;
			border-radius: 5px;
			display: none;
			z-index: 2;
    	}
    	input
    	{
    		position: absolute;
    		left: 88%;
    	}
    	hr
    	{
    		background-color: black;
    	}

    	/* repeat */
    	.repeat,.custom
    	{
    		position: absolute;
			width: 50%;
			top:20%;
			left: 25%;
			height: 60%;
			background-color: red;
			overflow: scroll;
			border-radius: 5px;
			z-index: 2;
			display: none;
    	}

    	/* date picker */
    	body
    	{
        	background-color: var(--background-color);
        	color: var(--text-color);
    	}
    
   		::-webkit-scrollbar 
    	{
        	width: 0px;
    	}

    	.title
    	{
    	    top:15%;
    	    height: 10%;
    	    text-align: center;
    	    font-size: 30px;
    	    position: absolute;
    	    margin-left: 7.5%;
    	    width: 85%;
    	    background-color: var(--panel-color);
    	    color: var(--text-color);
    	    overflow: scroll;    
    	    border:1px solid;
    	    z-index: 2;
    	}
    	.content
    	{ 
    	    top:25%;
    	    position: absolute;
    	    margin-left: 7.5%;
    	    width: 15%;
    	    background-color: var(--panel-color);
    	    color: var(--text-color);
    	    max-height: 60%;
    	    overflow: scroll;    
    	    border:1px solid;
    	    border-top: none;
    	    z-index: 2;
    	}
	
    	.content a 
    	{
    	    color: var(--text-color);
    	    padding: 12px 16px;
    	    text-decoration: none;
    	    display: block;
    	}
    	.content a:hover
    	{
    	  background-color: pink;
    	}


    	/* customize the repetition */
    	.dropdown
		{
  			font-size: 20px;  
			border: none;
  			outline: none;
  			padding: 1.8%;
  			background-color: var(--panel-color);
  			color: var(--text-color);
  			position: absolute;
			text-align: left;
			margin-left: 3%;
			top:3%;
			width: 40%;
			height: 10%;
			border-radius: 5px;
			cursor: pointer;
		}

		.dropDownRepeat
		{
			transition: 0.5s;
			position: absolute;
			margin-left: 3%;
			width: 40%;
			top:13%;
  			background-color: var(--background-color);
  			box-shadow: 0px 4px 8px 0px;

  			z-index: 2;
  			max-height: 50%;
  			overflow: scroll;
  			border-bottom-left-radius: 10px;
  			border-bottom-right-radius: 10px;
		}

		.dropDownRepeat a
		{
			padding: 8px 16px;
			cursor: pointer;
			display: block;
			text-decoration: none;
		}
		.dropDownRepeat a:hover
		{
			background-color: pink;
		}

		.week
		{
			position: absolute;
			top:66%;
			margin-left: 3%;
			width: 100%;
			transition: 0.5s;
		}

		.effective
		{
			position: absolute;
			top:30%;
			width: 40%;
			margin-left: 30%;
			height: 40%;
			z-index: 2;
			background-color: red;
			display: none;
		}
	</style>
</head>
<body>

	<!-- datePicker html -->
	<div id = "datePicker" style="display: none;">
	
		<div id = "title" class="title">Mon, Dec 2, 2019 7:00AM</div>
    		<div class = "content" id = "date" style="left:0%; border-right: none; width: 40%; font-family: courier">	 
    	</div>
    	
    	<div class = "content" id = "hour" style="left:40%"> 
        <a id = "hour1" href="#">1</a>
        <a id = "hour2" href="#">2</a>
        <a id = "hour3" href="#">3</a>
        <a id = "hour4" href="#">4</a>
        <a id = "hour5" href="#">5</a>
        <a id = "hour6" href="#">6</a>
        <a id = "hour7" href="#">7</a>
        <a id = "hour8" href="#">8</a>
        <a id = "hour9" href="#">9</a>
        <a id = "hour10" href="#">10</a>
        <a id = "hour11" href="#">11</a>
        <a id = "hour12" href="#">12</a>
    	</div>
	
    	<div class = "content" id = "minute" style="left:55%; border-right: none;border-left: none;"> 
        <a href = "#" id = "minute0">00</a>
        <a href = "#" id = "minute1">01</a>
        <a href = "#" id = "minute2">02</a>
        <a href = "#" id = "minute3">03</a>
        <a href = "#" id = "minute4">04</a>
        <a href = "#" id = "minute5">05</a>
        <a href = "#" id = "minute6">06</a>
        <a href = "#" id = "minute7">07</a>
        <a href = "#" id = "minute8">08</a>
        <a href = "#" id = "minute9">09</a>
        <a href = "#" id = "minute10">10</a>
        <a href = "#" id = "minute11">11</a>
        <a href = "#" id = "minute12">12</a>
        <a href = "#" id = "minute13">13</a>
        <a href = "#" id = "minute14">14</a>
        <a href = "#" id = "minute15">15</a>
        <a href = "#" id = "minute16">16</a>
        <a href = "#" id = "minute17">17</a>
        <a href = "#" id = "minute18">18</a>
        <a href = "#" id = "minute19">19</a>
        <a href = "#" id = "minute20">20</a>
        <a href = "#" id = "minute21">21</a>
        <a href = "#" id = "minute22">22</a>
        <a href = "#" id = "minute23">23</a>
        <a href = "#" id = "minute24">24</a>
        <a href = "#" id = "minute25">25</a>
        <a href = "#" id = "minute26">26</a>
        <a href = "#" id = "minute27">27</a>
        <a href = "#" id = "minute28">28</a>
        <a href = "#" id = "minute29">29</a>
        <a href = "#" id = "minute30">30</a>
        <a href = "#" id = "minute31">31</a>
        <a href = "#" id = "minute32">32</a>
        <a href = "#" id = "minute33">33</a>
        <a href = "#" id = "minute34">34</a>
        <a href = "#" id = "minute35">35</a>
        <a href = "#" id = "minute36">36</a>
        <a href = "#" id = "minute37">37</a>
        <a href = "#" id = "minute38">38</a>
        <a href = "#" id = "minute39">39</a>
        <a href = "#" id = "minute40">40</a>
        <a href = "#" id = "minute41">41</a>
        <a href = "#" id = "minute42">42</a>
        <a href = "#" id = "minute43">43</a>
        <a href = "#" id = "minute44">44</a>
        <a href = "#" id = "minute45">45</a>
        <a href = "#" id = "minute46">46</a>
        <a href = "#" id = "minute47">47</a>
        <a href = "#" id = "minute48">48</a>
        <a href = "#" id = "minute49">49</a>
        <a href = "#" id = "minute50">50</a>
        <a href = "#" id = "minute51">51</a>
        <a href = "#" id = "minute52">52</a>
        <a href = "#" id = "minute53">53</a>
        <a href = "#" id = "minute54">54</a>
        <a href = "#" id = "minute55">55</a>
        <a href = "#" id = "minute56">56</a>
        <a href = "#" id = "minute57">57</a>
        <a href = "#" id = "minute58">58</a>
        <a href = "#" id = "minute59">59</a>
    	</div>
    	<div class="content" id = "period" style="left: 70%; height: 60%;">
    	    <a href="#" id ="am">AM</a>
    	    <a href="#" id ="pm">PM</a>
    	</div>
    	<div style="position: absolute; top:70%; left: 79%; z-index: 2">
    	    <button id = "cancel"type="button" class="btn btn-danger" style="width:100px">Cancel</button>
    	</div>
    	<div style="position: absolute; top: 60%; left: 79%;z-index: 2">
    	    <button id = "ok" type="button" class="btn btn-primary" style="width:100px;background-color:green">Ok</	button>
    	</div>
	</div>

	<!-- alarm html -->
	<div class="reminder">
		<div style="position: relative;top: 15px; cursor: pointer;">
        	<div> <span>None</span><input type="radio" name = "alram"></div><hr>
        	<div><span>At time of event</span><input type="radio"  name = "alram"></div><hr>
        	<div><span>5 minutes before</span><input type="radio"  name = "alram"> </div><hr>
        	<div><span>10 minutes before</span><input type="radio"  name = "alram"></div><hr>
        	<div><span>15 minutes before</span><input type="radio"  name = "alram"></div><hr>
        	<div><span>20 minutes before</span><input type="radio"  name = "alram"></div><hr>
        	<div><span>25 minutes before</span><input type="radio"  name = "alram"></div><hr>
        	<div><span>30 minutes before</span><input type="radio"  name = "alram"></div><hr>
        	<div><span>1 hour before</span><input type="radio"  name = "alram"></div><hr>
        	<div><span>2 hours before</span><input type="radio"  name = "alram"></div><hr>
        	<div><span>1 day before</span><input type="radio"  name = "alram"></div><hr>
        	<div><span>2 days before</span><input type="radio"  name = "alram"></div> <hr>
        	<div><span>1 week before</span><input type="radio"  name = "alram"></div><br>
       	</div>
	</div>

	<div class="repeat">
		<div style="position: relative;top: 15px; cursor: pointer;">
        	<div><span>Never</span><input type="radio" name = "repeat"></div><hr>
        	<div><span>Every day</span><input type="radio"  name = "repeat"></div><hr>
        	<div><span>Every week</span><input type="radio"  name = "repeat"> </div><hr>
        	<div><span>Every month</span><input type="radio"  name = "repeat"></div><hr>
        	<div><span>Every year</span><input type="radio"  name = "repeat"></div><hr>
        	<div><span>Custom</span><input type="radio"  name = "repeat"></div><hr>
       	</div>
	</div>

	<div class="custom">
		<div class = "dropdown" id = "repeatNumberDropDown">
			<span id = "repeatNumberText">1</span>
			<i class="fa fa-caret-down" style="position:absolute; right:25px; font-size: 20px"></i>		
		</div>
		<div class="dropDownRepeat" id = "repeatNumber">
				<a href="#">1</a>
				<a href="#">2</a>
				<a href="#">3</a>
				<a href="#">4</a>
				<a href="#">5</a>
				<a href="#">6</a>
		</div>

		<div class="dropdown" id = "repeatTypeDropDown" style="left: 50%">
			<span id ="repeatTypeText" >week</span>
			<i class="fa fa-caret-down" style="position:absolute; right:25px; font-size: 20px"></i>		
		</div>
		<div class="dropDownRepeat" id = "repeatType" style="left: 50%">
				<a href="#">day</a>
				<a href="#">week</a>
				<a href="#">month</a>
				<a href="#">year</a>
		</div>
		<div class="week">
			<div id = "days" style="position: relative;top: 15px; cursor: pointer;">
				<div>Sunday<input type="checkbox" style="position:absolute; right: 20px"><hr></div>
				<div>Monday<input type="checkbox" style="position:absolute; right: 20px"><hr></div>
				<div>Tuesday<input type="checkbox" style="position:absolute; right: 20px"><hr></div>	
				<div>Wednesday<input type="checkbox" style="position:absolute; right: 20px"><hr></div>
				<div>Thursday<input type="checkbox" style="position:absolute; right: 20px"><hr></div>
				<div>Friday<input type="checkbox" style="position:absolute; right: 20px"><hr></div>
				<div>Saturday<input type="checkbox" style="position:absolute; right: 20px"><hr></div>
			</div>
			<div id = "effectiveEntry" style="position: relative;top: 15px; cursor: pointer;">
				<span style="margin-left: 0">Effective</span><span style="position: absolute; right: 35px" id = "effectiveText">Forever</span>
			</div>
			<div id = "until_a_date"  style="position: relative;top: 15px; cursor: pointer">
				 <br>
				 <div><input id = "date" type = "date" style="position: relative; left: 0;font-size: 100%; width: 170px;background: silver"></div>
			</div>
		</div>
		
	</div>
	<div class="effective">
		<h3 style = "padding: 20px 0 0 5%">Effective</h3>
		<div id = "effective" style="position: relative;top: 15px; cursor: pointer;">
			<div><span>Forever</span><input type="radio" name = "effective"></div><hr>
        	<div><span>Until a date</span><input type="radio"  name = "effective"></div><hr>
        	<div><span>For a number of events</span><input type="radio"  name = "effective"> </div>
        </div>
	</div>


	<!-- main page -->
	<div class="header">
		<h4 style="margin-top: 1.5%"> 
		<a id = "close" href="#"><i class="fas fa-times"></i></a>
		<span> New Reminder </span>
		<a href="#" id = "save"><i class="fas fa-check" style="position: absolute; left: 85%;"></i></a>
	</h4>
	</div>

	<div class = "box">
		<br>
		<i class="fas fa-heading"></i>

		<pre contenteditable="true" id = "title"></pre>
		
		<hr>


		<div id = "startTime" style="cursor: pointer; width: 100%">
			<i class="far fa-clock"></i>
			<span>Start</span>
			<span id = "startTimeText" style="position: absolute; right: 35px"></span>
		</div>
		<hr>
		
		<div id = "endTime" style="cursor: pointer; width: 100%">
			<i class="far fa-clock"></i>
			<span>End</span> &nbsp;
			<span id = "endTimeText" style="position: absolute; right: 35px"></span>
		</div>
		<hr>
		<div id = "alarm" style="cursor: pointer;">
			<i class="far fa-bell"></i>
			<span>ADD REMINDER </span>
		</div>
		<div id = "alarmText" style="margin-left:11.3%"></div>
		
		<hr>
		<i class="far fa-comments"></i>
		<pre contenteditable="true" id = "description"></pre>
		<hr>
		
		<div id ="repeat" style="cursor: pointer; width: 100%">
			<i class="fas fa-sync"></i>
			<span>Repeat</span>
			<span id = "repeatText" style="position: absolute; right: 35px">Never</span>
		</div>
		
	</div>
	<script type="text/javascript">
		const $ = require("jQuery");
		const fs = require("fs");
		const reminderThread = require('electron').ipcRenderer;
		const remote = require('electron').remote;  
		const {Reminder} = require("../js/reminder.js");
		const reminder = new Reminder();
		const {Confirmation} = require("../js/confirmation.js");
		
		const alarmDict = {
			"At time of event":0,
			"5 minutes before":0,
			"10 minutes before":0,
			"15 minutes before":0,
			"20 minutes before":0,
			"25 minutes before":0,
			"30 minutes before":0,
			"1 hour before":0,
			"2 hours before":0,
			"1 day before":0,
			"2 days before":0,
			"1 week before":0,
		};
		function showReminder()
		{
			let string = "";
			$("#alarmText").text("");
			for(key in alarmDict)
			{
				if(alarmDict[key] == 1) string += '<div><hr>' + key + '<a href="#"><i class="fas fa-times"></i></a></div>'
			}
			$("#alarmText").append(string);
		}

		function setReminder(reminder)
		{
			reminder.title = $("#title").text();
			reminder.startTime = $("#startTimeText").text();
			reminder.endTime = $("#endTimeText").text();
			reminder.description = $("#description").text();
		}
		$("#startTime").click(function(){
			timeType = "start";
			$("#datePicker").css({"display":"block","z-index":2});
			scrollToToday();
		})

		$("#endTime").click(function(){
			timeType = "end";
			$("#datePicker").css({"display":"block","z-index":2});
			scrollToToday();
		})

		$("#close").click(function(){
			/* send the message to main.js to open cofimation page */
			var confirmation = new Confirmation(
				"REMINDER_CANCELLATION",     //type
				"Discard",			  //title
				"Are your sure you don't want to save your changes?", // text
				["Cancel","Yes"]   //buttonlabels 
			);
			reminderThread.send("openConfirmation",confirmation);
		})
		reminderThread.on("REMINDER_CANCELLATION",function(){
			console.log("canel");
		})
		$("#save").click(function(){
			window.location.href = "calendar.html";
		})

		$("#alarm").click(function(){
			$(".reminder").css({"display":"block"});
		})

		$("#repeat").click(function(){
			$(".repeat").css({"display":"block"});
		})
		
		$('body').on('click',".reminder div div",function(){
			let text = $(this).children("span").text();
			$(this).children("input").prop("checked", true);
			if(text != "None" && alarmDict[text] == 0)
			{
				console.log(text);
				alarmDict[text] = 1;
				showReminder();
			}
			$(".reminder").css("display","none");
		})

		$('body').on('click',".repeat div div",function(){
			let text = $(this).children("span").text();
			$(this).children("input").prop("checked", true);
			$("#repeatText").text(text);
			$(".repeat").css("display","none");
			if(text == "Custom") $(".custom").css("display","block");

		})


		$('body').on('click',"#alarmText a",function(){
			alarmDict[$(this).parent().text()] = 0;
			$(this).parent().remove();
		})

	</script>
	<script src = "../js/date_picker.js"></script>
	<script src = "../js/customize_repeat.js"></script>
	<script src = "../js/effective.js"></script>
</body>
</html>